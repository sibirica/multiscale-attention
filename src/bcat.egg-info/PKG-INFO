Metadata-Version: 2.4
Name: bcat
Version: 0.1.0
Summary: BCAT
Requires-Python: >=3.11
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: torch>=2.5.1
Requires-Dist: numpy
Requires-Dist: sympy
Requires-Dist: pandas
Requires-Dist: matplotlib
Requires-Dist: seaborn
Requires-Dist: omegaconf
Requires-Dist: hydra-core
Requires-Dist: h5py
Requires-Dist: scipy
Requires-Dist: tabulate
Requires-Dist: tqdm
Requires-Dist: wandb
Requires-Dist: einops
Requires-Dist: torchdata==0.7.1
Requires-Dist: torchinfo
Requires-Dist: torchmetrics
Requires-Dist: rotary-embedding-torch
Requires-Dist: ema-pytorch
Requires-Dist: dadaptation
Requires-Dist: transformers
Requires-Dist: accelerate
Requires-Dist: diffusers[torch]
Requires-Dist: torch-harmonics
Requires-Dist: neuraloperator
Provides-Extra: dev
Requires-Dist: ruff; extra == "dev"
Requires-Dist: jupyter; extra == "dev"
Requires-Dist: ipython; extra == "dev"
Requires-Dist: pyclean; extra == "dev"
Dynamic: license-file

# BCAT: A Block Causal Transformer for PDE Foundation Models for Fluid Dynamics

This repository contains code for the paper [BCAT: A Block Causal Transformer for PDE Foundation Models for Fluid Dynamics](https://www.arxiv.org/abs/2501.18972).

The code is based on the repository [PROSE](https://github.com/felix-lyx/prose).

## Install dependencies

Using conda and the ```env.yml``` file:

```
conda env create --file=env.yml
```

Alternatively, to manually install:

```
conda create -n bcat python=3.11 ipython
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128 # or preferred version
pip install numpy sympy jupyter pandas matplotlib seaborn omegaconf h5py scikit-learn scipy tabulate hydra-core tqdm wandb einops
pip install torchao torchtune torchdata==0.7.1 torchinfo torchmetrics rotary-embedding-torch dadaptation transformers accelerate diffusers["torch"] torch-harmonics==0.6.5 neuraloperator
```

## Run the model

To launch a model training with modified arguments (arg1,val1), (arg2,val2):

```
python main.py arg1=val1 arg2=val2
```

All default arguments can be found in the ```src/configs``` folder, and are managed using [Hydra](https://hydra.cc/).

Scripts for reproducing the results in the paper are located in `src/scripts` folder. 

## Data

The dataset we used are collected from [PDEBench](https://github.com/pdebench/PDEBench), [PDEArena](https://github.com/pdearena/pdearena), and [CFDBench](https://github.com/luo-yining/CFDBench). More details about data preprocessing are included in ```src/data_utils/README.md```.


## Distributed training

Distributed training is available via PyTorch Distributed Data Parallel (DDP)

To launch a run on 1 node with 4 GPU, use 

```
torchrun --standalone --nnodes 1 --nproc_per_node 4 main.py
```

## Citation

If you find our paper and code useful, please consider citing:

[BCAT: A Block Causal Transformer for PDE Foundation Models for Fluid Dynamics](https://www.arxiv.org/abs/2501.18972)

```
@article{liu2025bcat,
  title={{BCAT}: A Block Causal Transformer for PDE Foundation Models for Fluid Dynamics},
  author={Yuxuan Liu and Jingmin Sun and Hayden Schaeffer},
  journal={arXiv preprint arXiv:2501.18972},
  year={2025}
}
```
